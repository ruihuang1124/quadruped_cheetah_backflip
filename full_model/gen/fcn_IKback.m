function [qb] = fcn_IKback(q,p,pBtoe)

qb = zeros(2,1);

  qb(1,1)=pi/2 - acos((2*((pBtoe(1) - q(1) + (p(2)*...
         cos(q(3)))/2)^2/2 - (pBtoe(2) - q(2))^2/2 - (pBtoe(1) - q(1))^2/2 + (pBtoe(2) - q(2) + (p(2)*sin(q(3)))/2)^2/2 + p(2)^2/8))/(p(2)*((pBtoe(2) - q(2) + (p(2)*...
         sin(q(3)))/2)^2 + (pBtoe(1) - q(1) + (p(2)*cos(q(3)))/2)^2)^(1/2))) - acos(((pBtoe(1) - q(1) + (p(2)*...
         cos(q(3)))/2)^2/2 + (pBtoe(2) - q(2) + (p(2)*sin(q(3)))/2)^2/2 + p(3)^2/2 - p(4)^2/2)/(p(3)*((pBtoe(2) - q(2) + (p(2)*...
         sin(q(3)))/2)^2 + (pBtoe(1) - q(1) + (p(2)*cos(q(3)))/2)^2)^(1/2)));
  qb(2,1)=acos(((pBtoe(1) - q(1) + (p(2)*cos(q(3)))/2)^2/2 + (pBtoe(2) - q(2) + (p(2)*...
         sin(q(3)))/2)^2/2 - p(3)^2/2 - p(4)^2/2)/(p(3)*p(4)));

 